# CKAN AWS Deployment Configuration
# Copy this file to .env and update the values for your environment.

# -----------------------------------------------------------------------------
# AWS Configuration
# -----------------------------------------------------------------------------
# Deployment environment name (e.g., dev, prod)
ENVIRONMENT=dev

# AWS Region where resources will be deployed
AWS_REGION=us-east-2

# AWS Profile to use (optional, uses default if commented out)
# Useful when managing multiple AWS accounts.
AWS_PROFILE=your-aws-profile

# Define a unique name so you can use this in all resource names (e.g., S3 bucket)
# Do not use underscore because S3 bucket names cannot contain underscores
UNIQUE_PROJECT_ID=CHANGE-ME

# -----------------------------------------------------------------------------
# Terraform Backend Configuration (for one-time setup)
# -----------------------------------------------------------------------------
# A globally unique name for the S3 bucket to store Terraform state.
# It's a good practice to include account ID and region for uniqueness.
# e.g., my-ckan-project-tfstate-123456789012-us-east-2
TF_STATE_BUCKET=ckan-to-aws-tf-state-${UNIQUE_PROJECT_ID}

# The path/key for the state file inside the S3 bucket.
TF_STATE_KEY=ckan/${ENVIRONMENT}/terraform.tfstate

# If you get something like 
# "An error occurred (AccessDeniedException) when calling the CreateTable operation: XXX
# is not authorized to perform: dynamodb:CreateTable on resource: XXX
# because no identity-based policy allows the dynamodb:CreateTable action
# Move this to false or ask your sysadmin to grant the required permissions.
TF_STATE_USE_DYNAMODB=true

# The name for the DynamoDB table used for state locking.
TF_STATE_DYNAMODB_TABLE=ckan-to-aws-terraform-state-lock

# Enable versioning on the S3 state bucket (recommended: true)
TF_STATE_BUCKET_VERSIONING=true

# -----------------------------------------------------------------------------
# VPC Configuration
# -----------------------------------------------------------------------------
# Set to false to use an existing VPC. If so, provide the IDs below.
CREATE_VPC=true

# --- If using an existing VPC (CREATE_VPC=false), uncomment and set these ---
# VPC_ID="vpc-xxxxxxxxxxxxxxxxx"
# PUBLIC_SUBNET_IDS='["subnet-xxxxxxxxxxxxxxxxx", "subnet-yyyyyyyyyyyyyyyyy"]'
# PRIVATE_SUBNET_IDS='["subnet-zzzzzzzzzzzzzzzzz", "subnet-aaaaaaaaaaaaaaaaa"]'
# DB_SUBNET_IDS='["subnet-bbbbbbbbbbbbbbbbb", "subnet-ccccccccccccccccc"]'

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
# Security Groups are always created (not reused) because they are application-specific
# and need to reference each other. You can restrict which IPs can access your application:

# CIDR blocks allowed to access the Application Load Balancer (your CKAN website)
# Default: 0.0.0.0/0 (open to the internet)
# Example for restricted access: '["203.0.113.0/24", "198.51.100.0/24"]'
ALLOWED_CIDR_BLOCKS='["0.0.0.0/0"]'
